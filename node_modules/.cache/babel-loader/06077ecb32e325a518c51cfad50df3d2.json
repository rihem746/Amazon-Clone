{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport { unstable_useForkRef as useForkRef, unstable_useId as useId } from '@mui/utils';\nimport { ActionTypes } from './useListbox.types';\nimport defaultReducer from './defaultListboxReducer';\nimport useControllableReducer from './useControllableReducer';\nimport areArraysEqual from '../utils/areArraysEqual';\n\nconst defaultOptionComparer = (optionA, optionB) => optionA === optionB;\n\nconst defaultIsOptionDisabled = () => false;\n\nexport default function useListbox(props) {\n  var _props$optionIdGenera, _options$highlightedI;\n\n  const {\n    disabledItemsFocusable = false,\n    disableListWrap = false,\n    focusManagement = 'activeDescendant',\n    id: idProp,\n    isOptionDisabled = defaultIsOptionDisabled,\n    listboxRef: externalListboxRef,\n    multiple = false,\n    optionComparer = defaultOptionComparer,\n    options,\n    stateReducer: externalReducer\n  } = props;\n  const id = useId(idProp);\n\n  function defaultIdGenerator(_, index) {\n    return `${id}-option-${index}`;\n  }\n\n  const optionIdGenerator = (_props$optionIdGenera = props.optionIdGenerator) != null ? _props$optionIdGenera : defaultIdGenerator;\n\n  const propsWithDefaults = _extends({}, props, {\n    disabledItemsFocusable,\n    disableListWrap,\n    focusManagement,\n    isOptionDisabled,\n    multiple,\n    optionComparer\n  });\n\n  const listboxRef = React.useRef(null);\n  const handleRef = useForkRef(externalListboxRef, listboxRef);\n  const [{\n    highlightedValue,\n    selectedValue\n  }, dispatch] = useControllableReducer(defaultReducer, externalReducer, propsWithDefaults);\n  const highlightedIndex = React.useMemo(() => {\n    return highlightedValue == null ? -1 : options.findIndex(option => optionComparer(option, highlightedValue));\n  }, [highlightedValue, options, optionComparer]);\n  const previousOptions = React.useRef([]);\n  React.useEffect(() => {\n    if (areArraysEqual(previousOptions.current, options, optionComparer)) {\n      return;\n    }\n\n    dispatch({\n      type: ActionTypes.optionsChange,\n      options,\n      previousOptions: previousOptions.current,\n      props: propsWithDefaults\n    });\n    previousOptions.current = options; // No need to re-run this effect if props change\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [options, optionComparer, dispatch]);\n  const setSelectedValue = React.useCallback(option => {\n    dispatch({\n      type: ActionTypes.setValue,\n      value: option\n    });\n  }, [dispatch]);\n  const setHighlightedValue = React.useCallback(option => {\n    dispatch({\n      type: ActionTypes.setHighlight,\n      highlight: option\n    });\n  }, [dispatch]);\n\n  const createHandleOptionClick = (option, other) => event => {\n    var _other$onClick;\n\n    (_other$onClick = other.onClick) == null ? void 0 : _other$onClick.call(other, event);\n\n    if (event.defaultPrevented) {\n      return;\n    }\n\n    event.preventDefault();\n    dispatch({\n      type: ActionTypes.optionClick,\n      option,\n      event,\n      props: propsWithDefaults\n    });\n  };\n\n  const createHandleOptionMouseOver = (option, other) => event => {\n    var _other$onMouseOver;\n\n    (_other$onMouseOver = other.onMouseOver) == null ? void 0 : _other$onMouseOver.call(other, event);\n\n    if (event.defaultPrevented) {\n      return;\n    }\n\n    dispatch({\n      type: ActionTypes.optionHover,\n      option,\n      event,\n      props: propsWithDefaults\n    });\n  };\n\n  const createHandleKeyDown = other => event => {\n    var _other$onKeyDown;\n\n    (_other$onKeyDown = other.onKeyDown) == null ? void 0 : _other$onKeyDown.call(other, event);\n\n    if (event.defaultPrevented) {\n      return;\n    }\n\n    const keysToPreventDefault = [' ', 'Enter', 'ArrowUp', 'ArrowDown', 'Home', 'End', 'PageUp', 'PageDown'];\n\n    if (keysToPreventDefault.includes(event.key)) {\n      event.preventDefault();\n    }\n\n    dispatch({\n      type: ActionTypes.keyDown,\n      event,\n      props: propsWithDefaults\n    });\n  };\n\n  const createHandleBlur = other => event => {\n    var _other$onBlur, _listboxRef$current;\n\n    (_other$onBlur = other.onBlur) == null ? void 0 : _other$onBlur.call(other, event);\n\n    if (event.defaultPrevented) {\n      return;\n    }\n\n    if ((_listboxRef$current = listboxRef.current) != null && _listboxRef$current.contains(document.activeElement)) {\n      // focus is within the listbox\n      return;\n    }\n\n    dispatch({\n      type: ActionTypes.blur,\n      event,\n      props: propsWithDefaults\n    });\n  };\n\n  const getRootProps = function () {\n    let otherHandlers = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    return _extends({}, otherHandlers, {\n      'aria-activedescendant': focusManagement === 'activeDescendant' && highlightedValue != null ? optionIdGenerator(highlightedValue, highlightedIndex) : undefined,\n      id,\n      onBlur: createHandleBlur(otherHandlers),\n      onKeyDown: createHandleKeyDown(otherHandlers),\n      role: 'listbox',\n      tabIndex: focusManagement === 'DOM' ? -1 : 0,\n      ref: handleRef\n    });\n  };\n\n  const getOptionState = option => {\n    let selected;\n    const index = options.findIndex(opt => optionComparer(opt, option));\n\n    if (multiple) {\n      var _ref;\n\n      selected = ((_ref = selectedValue) != null ? _ref : []).some(value => value != null && optionComparer(option, value));\n    } else {\n      selected = optionComparer(option, selectedValue);\n    }\n\n    const disabled = isOptionDisabled(option, index);\n    return {\n      selected,\n      disabled,\n      highlighted: highlightedIndex === index\n    };\n  };\n\n  const getOptionTabIndex = optionState => {\n    if (focusManagement === 'activeDescendant') {\n      return undefined;\n    }\n\n    if (!optionState.highlighted) {\n      return -1;\n    }\n\n    if (optionState.disabled && !disabledItemsFocusable) {\n      return -1;\n    }\n\n    return 0;\n  };\n\n  const getOptionProps = function (option) {\n    let otherHandlers = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const optionState = getOptionState(option);\n    const index = options.findIndex(opt => optionComparer(opt, option));\n    return _extends({}, otherHandlers, {\n      'aria-disabled': optionState.disabled || undefined,\n      'aria-selected': optionState.selected,\n      tabIndex: getOptionTabIndex(optionState),\n      id: optionIdGenerator(option, index),\n      onClick: createHandleOptionClick(option, otherHandlers),\n      onMouseOver: createHandleOptionMouseOver(option, otherHandlers),\n      role: 'option'\n    });\n  };\n\n  React.useDebugValue({\n    highlightedOption: options[highlightedIndex],\n    selectedOption: selectedValue\n  });\n  return {\n    getRootProps,\n    getOptionProps,\n    getOptionState,\n    highlightedOption: (_options$highlightedI = options[highlightedIndex]) != null ? _options$highlightedI : null,\n    selectedOption: selectedValue,\n    setSelectedValue,\n    setHighlightedValue\n  };\n}","map":{"version":3,"sources":["/home/rihem/Bureau/amazon-clone/node_modules/@mui/base/ListboxUnstyled/useListbox.js"],"names":["_extends","React","unstable_useForkRef","useForkRef","unstable_useId","useId","ActionTypes","defaultReducer","useControllableReducer","areArraysEqual","defaultOptionComparer","optionA","optionB","defaultIsOptionDisabled","useListbox","props","_props$optionIdGenera","_options$highlightedI","disabledItemsFocusable","disableListWrap","focusManagement","id","idProp","isOptionDisabled","listboxRef","externalListboxRef","multiple","optionComparer","options","stateReducer","externalReducer","defaultIdGenerator","_","index","optionIdGenerator","propsWithDefaults","useRef","handleRef","highlightedValue","selectedValue","dispatch","highlightedIndex","useMemo","findIndex","option","previousOptions","useEffect","current","type","optionsChange","setSelectedValue","useCallback","setValue","value","setHighlightedValue","setHighlight","highlight","createHandleOptionClick","other","event","_other$onClick","onClick","call","defaultPrevented","preventDefault","optionClick","createHandleOptionMouseOver","_other$onMouseOver","onMouseOver","optionHover","createHandleKeyDown","_other$onKeyDown","onKeyDown","keysToPreventDefault","includes","key","keyDown","createHandleBlur","_other$onBlur","_listboxRef$current","onBlur","contains","document","activeElement","blur","getRootProps","otherHandlers","undefined","role","tabIndex","ref","getOptionState","selected","opt","_ref","some","disabled","highlighted","getOptionTabIndex","optionState","getOptionProps","useDebugValue","highlightedOption","selectedOption"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport { unstable_useForkRef as useForkRef, unstable_useId as useId } from '@mui/utils';\nimport { ActionTypes } from './useListbox.types';\nimport defaultReducer from './defaultListboxReducer';\nimport useControllableReducer from './useControllableReducer';\nimport areArraysEqual from '../utils/areArraysEqual';\n\nconst defaultOptionComparer = (optionA, optionB) => optionA === optionB;\n\nconst defaultIsOptionDisabled = () => false;\n\nexport default function useListbox(props) {\n  var _props$optionIdGenera, _options$highlightedI;\n\n  const {\n    disabledItemsFocusable = false,\n    disableListWrap = false,\n    focusManagement = 'activeDescendant',\n    id: idProp,\n    isOptionDisabled = defaultIsOptionDisabled,\n    listboxRef: externalListboxRef,\n    multiple = false,\n    optionComparer = defaultOptionComparer,\n    options,\n    stateReducer: externalReducer\n  } = props;\n  const id = useId(idProp);\n\n  function defaultIdGenerator(_, index) {\n    return `${id}-option-${index}`;\n  }\n\n  const optionIdGenerator = (_props$optionIdGenera = props.optionIdGenerator) != null ? _props$optionIdGenera : defaultIdGenerator;\n\n  const propsWithDefaults = _extends({}, props, {\n    disabledItemsFocusable,\n    disableListWrap,\n    focusManagement,\n    isOptionDisabled,\n    multiple,\n    optionComparer\n  });\n\n  const listboxRef = React.useRef(null);\n  const handleRef = useForkRef(externalListboxRef, listboxRef);\n  const [{\n    highlightedValue,\n    selectedValue\n  }, dispatch] = useControllableReducer(defaultReducer, externalReducer, propsWithDefaults);\n  const highlightedIndex = React.useMemo(() => {\n    return highlightedValue == null ? -1 : options.findIndex(option => optionComparer(option, highlightedValue));\n  }, [highlightedValue, options, optionComparer]);\n  const previousOptions = React.useRef([]);\n  React.useEffect(() => {\n    if (areArraysEqual(previousOptions.current, options, optionComparer)) {\n      return;\n    }\n\n    dispatch({\n      type: ActionTypes.optionsChange,\n      options,\n      previousOptions: previousOptions.current,\n      props: propsWithDefaults\n    });\n    previousOptions.current = options; // No need to re-run this effect if props change\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [options, optionComparer, dispatch]);\n  const setSelectedValue = React.useCallback(option => {\n    dispatch({\n      type: ActionTypes.setValue,\n      value: option\n    });\n  }, [dispatch]);\n  const setHighlightedValue = React.useCallback(option => {\n    dispatch({\n      type: ActionTypes.setHighlight,\n      highlight: option\n    });\n  }, [dispatch]);\n\n  const createHandleOptionClick = (option, other) => event => {\n    var _other$onClick;\n\n    (_other$onClick = other.onClick) == null ? void 0 : _other$onClick.call(other, event);\n\n    if (event.defaultPrevented) {\n      return;\n    }\n\n    event.preventDefault();\n    dispatch({\n      type: ActionTypes.optionClick,\n      option,\n      event,\n      props: propsWithDefaults\n    });\n  };\n\n  const createHandleOptionMouseOver = (option, other) => event => {\n    var _other$onMouseOver;\n\n    (_other$onMouseOver = other.onMouseOver) == null ? void 0 : _other$onMouseOver.call(other, event);\n\n    if (event.defaultPrevented) {\n      return;\n    }\n\n    dispatch({\n      type: ActionTypes.optionHover,\n      option,\n      event,\n      props: propsWithDefaults\n    });\n  };\n\n  const createHandleKeyDown = other => event => {\n    var _other$onKeyDown;\n\n    (_other$onKeyDown = other.onKeyDown) == null ? void 0 : _other$onKeyDown.call(other, event);\n\n    if (event.defaultPrevented) {\n      return;\n    }\n\n    const keysToPreventDefault = [' ', 'Enter', 'ArrowUp', 'ArrowDown', 'Home', 'End', 'PageUp', 'PageDown'];\n\n    if (keysToPreventDefault.includes(event.key)) {\n      event.preventDefault();\n    }\n\n    dispatch({\n      type: ActionTypes.keyDown,\n      event,\n      props: propsWithDefaults\n    });\n  };\n\n  const createHandleBlur = other => event => {\n    var _other$onBlur, _listboxRef$current;\n\n    (_other$onBlur = other.onBlur) == null ? void 0 : _other$onBlur.call(other, event);\n\n    if (event.defaultPrevented) {\n      return;\n    }\n\n    if ((_listboxRef$current = listboxRef.current) != null && _listboxRef$current.contains(document.activeElement)) {\n      // focus is within the listbox\n      return;\n    }\n\n    dispatch({\n      type: ActionTypes.blur,\n      event,\n      props: propsWithDefaults\n    });\n  };\n\n  const getRootProps = (otherHandlers = {}) => {\n    return _extends({}, otherHandlers, {\n      'aria-activedescendant': focusManagement === 'activeDescendant' && highlightedValue != null ? optionIdGenerator(highlightedValue, highlightedIndex) : undefined,\n      id,\n      onBlur: createHandleBlur(otherHandlers),\n      onKeyDown: createHandleKeyDown(otherHandlers),\n      role: 'listbox',\n      tabIndex: focusManagement === 'DOM' ? -1 : 0,\n      ref: handleRef\n    });\n  };\n\n  const getOptionState = option => {\n    let selected;\n    const index = options.findIndex(opt => optionComparer(opt, option));\n\n    if (multiple) {\n      var _ref;\n\n      selected = ((_ref = selectedValue) != null ? _ref : []).some(value => value != null && optionComparer(option, value));\n    } else {\n      selected = optionComparer(option, selectedValue);\n    }\n\n    const disabled = isOptionDisabled(option, index);\n    return {\n      selected,\n      disabled,\n      highlighted: highlightedIndex === index\n    };\n  };\n\n  const getOptionTabIndex = optionState => {\n    if (focusManagement === 'activeDescendant') {\n      return undefined;\n    }\n\n    if (!optionState.highlighted) {\n      return -1;\n    }\n\n    if (optionState.disabled && !disabledItemsFocusable) {\n      return -1;\n    }\n\n    return 0;\n  };\n\n  const getOptionProps = (option, otherHandlers = {}) => {\n    const optionState = getOptionState(option);\n    const index = options.findIndex(opt => optionComparer(opt, option));\n    return _extends({}, otherHandlers, {\n      'aria-disabled': optionState.disabled || undefined,\n      'aria-selected': optionState.selected,\n      tabIndex: getOptionTabIndex(optionState),\n      id: optionIdGenerator(option, index),\n      onClick: createHandleOptionClick(option, otherHandlers),\n      onMouseOver: createHandleOptionMouseOver(option, otherHandlers),\n      role: 'option'\n    });\n  };\n\n  React.useDebugValue({\n    highlightedOption: options[highlightedIndex],\n    selectedOption: selectedValue\n  });\n  return {\n    getRootProps,\n    getOptionProps,\n    getOptionState,\n    highlightedOption: (_options$highlightedI = options[highlightedIndex]) != null ? _options$highlightedI : null,\n    selectedOption: selectedValue,\n    setSelectedValue,\n    setHighlightedValue\n  };\n}"]},"metadata":{},"sourceType":"module"}